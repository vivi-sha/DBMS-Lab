create table DEPT(DEPTNO int, DNAME varchar(20),DLOC varchar(20),primary key(DEPTNO));
create table EMPLOYEE(EMPNO int,ENAME varchar(20),MGR_NO int, HIREDATE date, SAL int, DEPTNO int, primary key(EMPNO,DEPTNO),foreign key(DEPTNO) references DEPT(DEPTNO));
create table PROJECT(PNO int,PNAME varchar(20),PLOC varchar(20),primary key(PNO));
create table INCENTIVES(EMPNO int,INCENTIVE_DATE date,INCENTIVE_AMOUNT int, primary key(EMPNO),foreign key(EMPNO) references EMPLOYEE(EMPNO));
create table ASSIGNED_TO(EMPNO int,PNO int,JOB_ROLE varchar(20),primary key(EMPNO,PNO),FOREIGN KEY(EMPNO) references EMPLOYEE(EMPNO),FOREIGN KEY(PNO) REFERENCES PROJECT(PNO));

INSERT INTO DEPT (DEPTNO, DNAME, DLOC) VALUES (10, 'SALES', 'Bengaluru');
INSERT INTO DEPT (DEPTNO, DNAME, DLOC) VALUES (20, 'IT', 'Hyderabad');
INSERT INTO DEPT (DEPTNO, DNAME, DLOC) VALUES (30, 'HR', 'Mysuru');
INSERT INTO DEPT (DEPTNO, DNAME, DLOC) VALUES (40, 'R&D', 'Bengaluru');
INSERT INTO DEPT (DEPTNO, DNAME, DLOC) VALUES (50, 'MARKETING', 'Mumbai');
INSERT INTO DEPT (DEPTNO, DNAME, DLOC) VALUES (60, 'FINANCE', 'Hyderabad');

INSERT INTO PROJECT (PNO, PNAME, PLOC) VALUES (100, 'Alpha', 'Bengaluru');
INSERT INTO PROJECT (PNO, PNAME, PLOC) VALUES (200, 'Beta', 'Hyderabad');
INSERT INTO PROJECT (PNO, PNAME, PLOC) VALUES (300, 'Gamma', 'Mysuru');
INSERT INTO PROJECT (PNO, PNAME, PLOC) VALUES (400, 'Delta', 'Mumbai');
INSERT INTO PROJECT (PNO, PNAME, PLOC) VALUES (500, 'Omega', 'Bengaluru');
INSERT INTO PROJECT (PNO, PNAME, PLOC) VALUES (600, 'Zeta', 'Delhi');

INSERT INTO EMPLOYEE (EMPNO, ENAME, MGR_NO, HIREDATE, SAL, DEPTNO) VALUES (7001, 'Alice', 7004,'2020-01-15', 80000, 10);
INSERT INTO EMPLOYEE (EMPNO, ENAME, MGR_NO, HIREDATE, SAL, DEPTNO) VALUES (7002, 'Bob', 7005,'2019-03-22', 95000, 20);
INSERT INTO EMPLOYEE (EMPNO, ENAME, MGR_NO, HIREDATE, SAL, DEPTNO) VALUES (7003, 'Charlie', 7004,'2021-05-10', 60000, 30);
INSERT INTO EMPLOYEE (EMPNO, ENAME, MGR_NO, HIREDATE, SAL, DEPTNO) VALUES (7004, 'David', NULL, '2018-06-01', 120000, 10);
INSERT INTO EMPLOYEE (EMPNO, ENAME, MGR_NO, HIREDATE, SAL, DEPTNO) VALUES (7005, 'Eve', NULL, '2017-11-30', 110000, 20);
INSERT INTO EMPLOYEE (EMPNO, ENAME, MGR_NO, HIREDATE, SAL, DEPTNO) VALUES (7006, 'Frank', 7005, '2022-02-18', 75000, 50);

INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7001, 100, 'Manager');
INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7002, 200, 'Developer');
INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7003, 300, 'Recruiter');
INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7004, 100, 'Sales Lead');
INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7005, 500, 'Team Lead');
INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7001, 200, 'Supervisor');
INSERT INTO ASSIGNED_TO (EMPNO, PNO, JOB_ROLE) VALUES (7006, 400, 'Marketer');

INSERT INTO INCENTIVES (EMPNO, INCENTIVE_DATE, INCENTIVE_AMOUNT) VALUES (7001, '2023-01-01', 5000);
INSERT INTO INCENTIVES (EMPNO, INCENTIVE_DATE, INCENTIVE_AMOUNT) VALUES (7002, '2023-02-01', 3000);
INSERT INTO INCENTIVES (EMPNO, INCENTIVE_DATE, INCENTIVE_AMOUNT) VALUES (7004, '2023-01-15', 5000);

SELECT DISTINCT T1.EMPNO
FROM ASSIGNED_TO T1
JOIN PROJECT T2 ON T1.PNO = T2.PNO
WHERE T2.PLOC IN ('Bengaluru', 'Hyderabad', 'Mysuru');


SELECT E.EMPNO
FROM EMPLOYEE E
WHERE NOT EXISTS (
    SELECT 1
    FROM INCENTIVES I
    WHERE I.EMPNO = E.EMPNO
);

SELECT
    E.ENAME,
    E.EMPNO,
    D.DNAME AS DEPARTMENT_NAME,
    A.JOB_ROLE,
    D.DLOC AS DEPARTMENT_LOCATION,
    P.PLOC AS PROJECT_LOCATION
FROM
    EMPLOYEE E
JOIN
    DEPT D ON E.DEPTNO = D.DEPTNO
JOIN
    ASSIGNED_TO A ON E.EMPNO = A.EMPNO
JOIN
    PROJECT P ON A.PNO = P.PNO
WHERE
    D.DLOC = P.PLOC;
